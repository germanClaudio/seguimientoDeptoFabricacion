<!-- tabla Pendientes Finales -->
<table id="tablaOtPendientesFinales<%=k%>" class="table-responsive align-middle col-5 border-end border-dark" style="font-size: 10pt; width: 100%">
    <thead class="align-middle" style="background-color: #d8d8eb">
        <tr>
            <th colspan="3" class="text-center">PENDIENTES FINALES
                <% if (userInfo.admin || userInfo.area === 'fabricacion') { %>
                    <button id="posBtnAddDataOtPendientesFinales<%=k%>" type="button" name="btnOtPendientesFinales" class="btn btn-small btn-success shadow m-1 me-5 mb-2 position-relative" style="--bs-btn-font-size: .6rem; color: var(--bs-white);" title="Agregar/Modificar Datos" value="<%=k%>">
                        <i class="fa-solid fa-pencil fa-lg" aria-hidden="true"></i>
                        <span id="spanCheckSelecMasivePendFinales<%=k%>" class="position-absolute top-100 start-100 translate-middle badge rounded-pill bg-danger">
                            0
                            <span class="visually-hidden">Elementos seleccionados</span>
                        </span>
                    </button>
                <% } else { %>
                    <button type="button" class="btn btn-small btn-danger shadow m-1 me-5 mb-2 disabled" style="--bs-btn-font-size: .6rem; color: var(--bs-white);">
                        <i class="fa-solid fa-ban fa-lg" aria-hidden="true"></i>                                                    
                    </button>
                <% } %>
                <i class="fa-solid fa-arrows-spin fa-lg" style="color: #b09b12;"></i> En Proceso -
                <i class="fa-solid fa-circle-check fa-lg" style="color: #008f30;"></i> Terminado -
                <i class="fa-solid fa-circle-xmark fa-lg" style="color: #c40000;"></i> Detenido -
                <i class="fa-solid fa-ban fa-lg"></i> No Aplica -
                <i class="fa-solid fa-triangle-exclamation fa-lg" style="color: #1c21ac;"></i> Sin Datos
            </th>
        </tr>
        <tr>
            <th id="colData0" style="width:33vw" scope="col-1" class="text-center pb-1">Pend. MÃ¡quina | Estado | Rev.</th>
            <th id="colData1" style="width:33vw" scope="col-1" class="text-center pb-1">Pend. Ajuste | Estado | Rev.</th>
            <th id="colData2" style="width:33vw" scope="col-1" class="text-center pb-1">Notas | Estado | Rev.</th>
        </tr>
    </thead>
    <tbody class="table-group-divider">
        
        <% const pendientesFinalesConfig = {
            enProceso: { icon: "fa-arrows-spin fa-spin", iconColor: "color:#b09b12" },
            terminado: { icon: "fa-circle-check", iconColor: "color:#008f30" },
            detenido: { icon: "fa-circle-xmark", iconColor: "color:#c40000" },
            noAplica: { icon: "fa-ban", iconColor: "color:#000000" },
            default: { icon: "fa-triangle-exclamation", iconColor: "color:#1c21ac" }
        };

        proyecto[m].project[j].oci[k].otProject.forEach((ot, n) => {
            let pathMongoOtProject = proyecto[m].project[j].oci[k].otProject,
                pathMongoOtAjuste = pathMongoOtProject[n].otAjuste;

            let anteriorDisabled = "disabled", siguienteDisabled = "disabled",
                resDatoPendientesMaquina = "S/D", resEstadoPendientesMaquina = 'sinDato', resRevisionPendientesMaquina = 0,
                resDatoPendientesAjuste = "S/D", resEstadoPendientesAjuste = 'sinDato', resRevisionPendientesAjuste = 0,
                resDatoNotasAjuste = "S/D", resRevisionNotasAjuste = 0;

            if (pathMongoOtProject[n].visible) {
                let pathToMongoOtPendientesFinales = pathMongoOtAjuste[0].otPendientesFinales || [],
                    largoArrayPendientesFinales = parseInt(pathToMongoOtPendientesFinales.length);

                let arrResDatoPendientesMaquina = [], arrResEstadoPendientesMaquina = [], valueArrayResPendientesMaquina = 0, arrResRevisionPendientesMaquina = [],
                    arrResCreadorPendientesMaquina = [], arrResModificadorPendientesMaquina = [], arrResFechaPendientesMaquina = [], arrResFechaModPendientesMaquina = [];

                let arrResDatoPendientesAjuste = [], arrResEstadoPendientesAjuste = [], valueArrayResPendientesAjuste = 0, arrResRevisionPendientesAjuste = [],
                    arrResCreadorPendientesAjuste = [], arrResModificadorPendientesAjuste = [], arrResFechaPendientesAjuste = [], arrResFechaModPendientesAjuste = [];

                let arrResDatoNotasAjuste = [], valueArrayResNotasAjuste = 0, arrResRevisionNotasAjuste = [],
                    arrResCreadorNotasAjuste = [], arrResModificadorNotasAjuste = [], arrResFechaNotasAjuste = [], arrResFechaModNotasAjuste = [];

                if (pathMongoOtProject[n].otStatus) { %>
                    <!--Activo-->
                    <tr name="rowSelected<%=k%>_<%=n%>" class="border-bottom" style="height: 7vh;">
                        <% for (let q = 38; totalColDataPendientesFinales > q; q++) {
                            if (q==38) { %>
                                <!-- Pendientes Maquina data Activo--> 
                                <td class="text-center align-middle">
                                    <% if (largoArrayPendientesFinales > 0) {

                                        for (let i = 0; largoArrayPendientesFinales > i; i++) {
                                            if (pathToMongoOtPendientesFinales[i]) {
                                                let largoArray = parseInt(largoArrayPendientesFinales)
                                                resDatoPendientesMaquina = pathToMongoOtPendientesFinales[largoArray-1].pendientesMaquina == 'sinDato' ? "S/D" : pathToMongoOtPendientesFinales[largoArray-1].pendientesMaquina
                                                resEstadoPendientesMaquina = pathToMongoOtPendientesFinales[largoArray-1].estadoPendientesMaquina == 'sinDato' ? "S/D" : pathToMongoOtPendientesFinales[largoArray-1].estadoPendientesMaquina
                                                resRevisionPendientesMaquina = parseInt(pathToMongoOtPendientesFinales[largoArray-1].revisionPendientesMaquina) || 0
                                                
                                                pathToMongoOtPendientesFinales[i].pendientesMaquina == 'sinDato' ? arrResDatoPendientesMaquina.push("S/D") : arrResDatoPendientesMaquina.push(pathToMongoOtPendientesFinales[i].pendientesMaquina)
                                                pathToMongoOtPendientesFinales[i].estadoPendientesMaquina == 'sinDato' ? arrResEstadoPendientesMaquina.push("S/D") : arrResEstadoPendientesMaquina.push(pathToMongoOtPendientesFinales[i].estadoPendientesMaquina)
                                                arrResRevisionPendientesMaquina.push(pathToMongoOtPendientesFinales[i].revisionPendientesMaquina)

                                                arrResCreadorPendientesMaquina.push(pathToMongoOtPendientesFinales[i].creator[0].username)
                                                arrResModificadorPendientesMaquina.push(pathToMongoOtPendientesFinales[i].modificator[0].username)
                                                arrResFechaPendientesMaquina.push(pathToMongoOtPendientesFinales[i].timestamp)
                                                arrResFechaModPendientesMaquina.push(pathToMongoOtPendientesFinales[i].modifiedOn)
                                            }
                                        }
                                        valueArrayResPendientesMaquina = parseInt(arrResDatoPendientesMaquina.length-1)

                                        if (arrResDatoPendientesMaquina.length == 1 ) {
                                            anteriorDisabled = "disabled"
                                            siguienteDisabled = "disabled"
                                        } else if (arrResDatoPendientesMaquina.length == arrResRevisionPendientesMaquina.length) {
                                            anteriorDisabled = ""
                                            siguienteDisabled = "disabled"
                                        } else {
                                            anteriorDisabled = ""
                                            siguienteDisabled = "disabled"
                                        }
                                        
                                    } else {
                                        arrResDatoPendientesMaquina.push(resDatoPendientesMaquina)
                                        arrResEstadoPendientesMaquina.push(resEstadoPendientesMaquina)
                                        arrResRevisionPendientesMaquina.push(resRevisionPendientesMaquina)
                                        
                                        arrResCreadorPendientesMaquina.push(pathMongoOtProject[n].creator[0].username)
                                        arrResModificadorPendientesMaquina = ""
                                        arrResFechaPendientesMaquina.push(pathMongoOtProject[n].timestamp)
                                        arrResFechaModPendientesMaquina = ""
                                    } %>
                                    
                                    <div id="btnAnteriorSiguientePendientesMaquina<%=k%>_<%=n%>_<%=q%>">
                                        <button id="btnAnteriorPendientesMaquina<%=k%>_<%=n%>_<%=q%>" name="btnAnteriorPendientesMaquina" value="<%=k%>_<%=n%>_<%=q%>" class="btn btn-light btn-sm me-2" title="Ver anterior" type="button"
                                            style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .35rem; --bs-btn-font-size: .75rem; color: var(--bs-black); cursor: pointer;"
                                            <%= anteriorDisabled %>
                                            ><i class="fa-solid fa-arrow-left"></i>
                                        </button>
                                        <input type="hidden" id="resDatoHidden<%=k%>_<%=n%>_<%=q%>" value="<%= arrResDatoPendientesMaquina %>">
                                        <input type="hidden" id="resEstadoHidden<%=k%>_<%=n%>_<%=q%>" value="<%= arrResEstadoPendientesMaquina %>">
                                        <input type="hidden" id="resIndexHidden<%=k%>_<%=n%>_<%=q%>" value="<%= valueArrayResPendientesMaquina %>">
                                        <input type="hidden" id="resRevisionHidden<%=k%>_<%=n%>_<%=q%>" value="<%= arrResRevisionPendientesMaquina %>">
                                        <input type="hidden" id="arrResCreadorHidden<%=k%>_<%=n%>_<%=q%>" value="<%= arrResCreadorPendientesMaquina %>">
                                        <input type="hidden" id="arrResModificadorHidden<%=k%>_<%=n%>_<%=q%>" value="<%= arrResModificadorPendientesMaquina %>">
                                        <input type="hidden" id="arrResFechaHidden<%=k%>_<%=n%>_<%=q%>" value="<%= arrResFechaPendientesMaquina %>">
                                        <input type="hidden" id="arrResFechaModificacionHidden<%=k%>_<%=n%>_<%=q%>" value="<%= arrResFechaModPendientesMaquina %>">

                                        <span id="resDatoPendientesMaquina<%=k%>_<%=n%>_<%=q%>" class="badge bg-light text-dark my-2">
                                            <%= resDatoPendientesMaquina %>
                                        </span> |
                                        
                                        <% const config = pendientesFinalesConfig[resEstadoPendientesMaquina] || pendientesFinalesConfig.default; %>
                                        <span id="resEstadoPendientesMaquina<%=k%>_<%=n%>_<%=q%>" value="<%=resEstadoPendientesMaquina%>">
                                            <i class="fa-solid <%= config.icon %> fa-lg" style="<%= config.iconColor %>"></i>
                                        </span> |

                                        <span id="resRevisionPendientesMaquina<%=k%>_<%=n%>_<%=q%>" name="resRevisionPendientesMaquina" class="badge text-dark my-2" style="cursor: help;" valueCreador="" valueFecha="" valueModificador="" valueFechaMod="">
                                            <%= resRevisionPendientesMaquina %>
                                        </span>

                                        <button id="btnSiguientePendientesMaquina<%=k%>_<%=n%>_<%=q%>" name="btnSiguientePendientesMaquina" value="<%=k%>_<%=n%>_<%=q%>" class="btn btn-light btn-sm ms-2" title="Ver siguiente" type="button"
                                            style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .35rem; --bs-btn-font-size: .75rem; color: var(--bs-black); cursor: pointer;" <%= siguienteDisabled %>
                                            ><i class="fa-solid fa-arrow-right"></i>
                                        </button>
                                    </div>
                                </td>

                            <% } else if (q==39) { %>
                                <!-- Pendientes Ajuste data Activo-->
                                <td class="text-center align-middle">
                                    <% if (largoArrayPendientesFinales > 0) {

                                        for (let i = 0; largoArrayPendientesFinales > i; i++) {
                                            if (pathToMongoOtPendientesFinales[i]) {
                                                let largoArray = parseInt(largoArrayPendientesFinales)
                                                resDatoPendientesAjuste = pathToMongoOtPendientesFinales[largoArray-1].pendientesAjuste == 'sinDato' ? "S/D" :  pathToMongoOtPendientesFinales[largoArray-1].pendientesAjuste
                                                resEstadoPendientesAjuste = pathToMongoOtPendientesFinales[largoArray-1].estadoPendientesAjuste == 'sinDato' ? "S/D" : pathToMongoOtPendientesFinales[largoArray-1].estadoPendientesAjuste
                                                resRevisionPendientesAjuste = parseInt(pathToMongoOtPendientesFinales[largoArray-1].revisionPendientesAjuste) || 0
                                                
                                                pathToMongoOtPendientesFinales[i].pendientesAjuste == 'sinDato' ? arrResDatoPendientesAjuste.push("S/D") : arrResDatoPendientesAjuste.push(pathToMongoOtPendientesFinales[i].pendientesAjuste)
                                                pathToMongoOtPendientesFinales[i].estadoPendientesAjuste == 'sinDato' ? arrResEstadoPendientesAjuste.push("S/D") : arrResEstadoPendientesAjuste.push(pathToMongoOtPendientesFinales[i].estadoPendientesAjuste)
                                                arrResRevisionPendientesAjuste.push(pathToMongoOtPendientesFinales[i].revisionPendientesAjuste)
                                                
                                                arrResCreadorPendientesAjuste.push(pathToMongoOtPendientesFinales[i].creator[0].username)
                                                arrResModificadorPendientesAjuste.push(pathToMongoOtPendientesFinales[i].modificator[0].username)
                                                arrResFechaPendientesAjuste.push(pathToMongoOtPendientesFinales[i].timestamp)
                                                arrResFechaModPendientesAjuste.push(pathToMongoOtPendientesFinales[i].modifiedOn)
                                            }
                                        }
                                        valueArrayResPendientesAjuste = parseInt(arrResEstadoPendientesAjuste.length-1)
                                                
                                        if (arrResDatoPendientesAjuste.length == 1 ) {
                                            anteriorDisabled = "disabled"
                                            siguienteDisabled = "disabled"
                                        } else if (arrResDatoPendientesAjuste.length == arrResRevisionPendientesAjuste.length) {
                                            anteriorDisabled = ""
                                            siguienteDisabled = "disabled"
                                        } else {
                                            anteriorDisabled = ""
                                            siguienteDisabled = "disabled"
                                        }
                                        
                                    } else {
                                        arrResDatoPendientesAjuste.push(resDatoPendientesAjuste)
                                        arrResEstadoPendientesAjuste.push(resEstadoPendientesAjuste)
                                        arrResRevisionPendientesAjuste.push(resRevisionPendientesAjuste)
                                        
                                        arrResCreadorPendientesAjuste.push(pathMongoOtProject[n].creator[0].username)
                                        arrResModificadorPendientesAjuste = ""
                                        arrResFechaPendientesAjuste.push(pathMongoOtProject[n].timestamp)
                                        arrResFechaModPendientesAjuste = ""
                                    } %>
                                    
                                    <div id="btnAnteriorSiguientePendientesAjuste<%=k%>_<%=n%>_<%=q%>">
                                        <button id="btnAnteriorPendientesAjuste<%=k%>_<%=n%>_<%=q%>" name="btnAnteriorPendientesAjuste" value="<%=k%>_<%=n%>_<%=q%>" class="btn btn-light btn-sm me-2" title="Ver anterior" type="button"
                                            style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .35rem; --bs-btn-font-size: .75rem; color: var(--bs-black); cursor: pointer;"
                                            <%= anteriorDisabled %>
                                            ><i class="fa-solid fa-arrow-left"></i>
                                        </button>
                                        <input type="hidden" id="resDatoHidden<%=k%>_<%=n%>_<%=q%>" value="<%= arrResDatoPendientesAjuste %>">
                                        <input type="hidden" id="resEstadoHidden<%=k%>_<%=n%>_<%=q%>" value="<%= arrResEstadoPendientesAjuste %>">
                                        <input type="hidden" id="resIndexHidden<%=k%>_<%=n%>_<%=q%>" value="<%= valueArrayResPendientesAjuste %>">
                                        <input type="hidden" id="resRevisionHidden<%=k%>_<%=n%>_<%=q%>" value="<%= arrResRevisionPendientesAjuste %>">
                                        <input type="hidden" id="arrResCreadorHidden<%=k%>_<%=n%>_<%=q%>" value="<%= arrResCreadorPendientesAjuste %>">
                                        <input type="hidden" id="arrResModificadorHidden<%=k%>_<%=n%>_<%=q%>" value="<%= arrResModificadorPendientesAjuste %>">
                                        <input type="hidden" id="arrResFechaHidden<%=k%>_<%=n%>_<%=q%>" value="<%= arrResFechaPendientesAjuste %>">
                                        <input type="hidden" id="arrResFechaModificacionHidden<%=k%>_<%=n%>_<%=q%>" value="<%= arrResFechaModPendientesAjuste %>">

                                        <span id="resDatoPendientesAjuste<%=k%>_<%=n%>_<%=q%>" class="badge bg-light text-dark my-2">
                                            <%= resDatoPendientesAjuste %>
                                        </span> |

                                        <% const config = pendientesFinalesConfig[resEstadoPendientesAjuste] || pendientesFinalesConfig.default; %>
                                        <span id="resEstadoPendientesAjuste<%=k%>_<%=n%>_<%=q%>" value="<%=resEstadoPendientesAjuste%>">
                                            <i   class="fa-solid <%= config.icon %> fa-lg" style="<%= config.iconColor %>"></i>
                                        </span> |

                                        <span id="resRevisionPendientesAjuste<%=k%>_<%=n%>_<%=q%>" name="resRevisionPendientesAjuste" class="badge text-dark my-2" style="cursor: help;" valueCreador="" valueFecha="" valueModificador="" valueFechaMod="">
                                            <%= resRevisionPendientesAjuste %>
                                        </span>

                                        <button id="btnSiguientePendientesAjuste<%=k%>_<%=n%>_<%=q%>" name="btnSiguientePendientesAjuste" value="<%=k%>_<%=n%>_<%=q%>" class="btn btn-light btn-sm ms-2" title="Ver siguiente" type="button"
                                            style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .35rem; --bs-btn-font-size: .75rem; color: var(--bs-black); cursor: pointer;"
                                            <%= siguienteDisabled %>
                                            ><i class="fa-solid fa-arrow-right"></i>
                                        </button>
                                    </div>
                                </td>

                            <% } else { %>
                                <!-- Notas Ajuste data Activo-->
                                <td class="text-center align-middle">
                                    <% if (largoArrayPendientesFinales > 0) {

                                        for (let i = 0; largoArrayPendientesFinales > i; i++) {
                                            if (pathToMongoOtPendientesFinales[i]) {
                                                let largoArray = parseInt(largoArrayPendientesFinales)
                                                resDatoNotasAjuste = pathToMongoOtPendientesFinales[largoArray-1].notasAjuste == 'sinDato' ? "S/D" : pathToMongoOtPendientesFinales[largoArray-1].notasAjuste
                                                resRevisionNotasAjuste = parseInt(pathToMongoOtPendientesFinales[largoArray-1].revisionNotasAjuste) || 0
                                                
                                                pathToMongoOtPendientesFinales[i].notasAjuste == 'sinDato' ? arrResDatoNotasAjuste.push('S/D') : arrResDatoNotasAjuste.push(pathToMongoOtPendientesFinales[i].notasAjuste)
                                                arrResRevisionNotasAjuste.push(pathToMongoOtPendientesFinales[i].revisionNotasAjuste)
                                                
                                                arrResCreadorNotasAjuste.push(pathToMongoOtPendientesFinales[i].creator[0].username)
                                                arrResModificadorNotasAjuste.push(pathToMongoOtPendientesFinales[i].modificator[0].username)
                                                arrResFechaNotasAjuste.push(pathToMongoOtPendientesFinales[i].timestamp)
                                                arrResFechaModNotasAjuste.push(pathToMongoOtPendientesFinales[i].modifiedOn)
                                            }
                                        }
                                        valueArrayResNotasAjuste = parseInt(arrResDatoNotasAjuste.length-1)
                                                
                                        if (arrResDatoNotasAjuste.length == 1 ) {
                                            siguienteDisabled = "disabled"
                                            anteriorDisabled = "disabled"
                                        } else if (arrResDatoNotasAjuste.length == arrResRevisionNotasAjuste.length) {
                                            anteriorDisabled = ""
                                            siguienteDisabled = "disabled"
                                        } else {
                                            anteriorDisabled = ""
                                            siguienteDisabled = "disabled"
                                        }
                                                
                                    } else {
                                        arrResDatoNotasAjuste.push(resDatoNotasAjuste)
                                        arrResRevisionNotasAjuste.push(resRevisionNotasAjuste)
                                        
                                        arrResCreadorNotasAjuste.push(pathMongoOtProject[n].creator[0].username)
                                        arrResModificadorNotasAjuste = ""
                                        arrResFechaNotasAjuste.push(pathMongoOtProject[n].timestamp)
                                        arrResFechaModNotasAjuste = ""
                                    } %>

                                <div id="btnAnteriorSiguienteNotasAjuste<%=k%>_<%=n%>_<%=q%>">
                                    <button id="btnAnteriorNotasAjuste<%=k%>_<%=n%>_<%=q%>" name="btnAnteriorNotasAjuste" value="<%=k%>_<%=n%>_<%=q%>" class="btn btn-light btn-sm me-2" title="Ver anterior" type="button"
                                        style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .35rem; --bs-btn-font-size: .75rem; color: var(--bs-black); cursor: pointer;"
                                        <%= anteriorDisabled %>
                                        ><i class="fa-solid fa-arrow-left"></i>
                                    </button>
                                    <input type="hidden" id="resDatoHidden<%=k%>_<%=n%>_<%=q%>" value="<%= arrResDatoNotasAjuste %>">
                                    <input type="hidden" id="resIndexHidden<%=k%>_<%=n%>_<%=q%>" value="<%= valueArrayResNotasAjuste %>">
                                    <input type="hidden" id="resRevisionHidden<%=k%>_<%=n%>_<%=q%>" value="<%= arrResRevisionNotasAjuste %>">
                                    <input type="hidden" id="arrResCreadorHidden<%=k%>_<%=n%>_<%=q%>" value="<%= arrResCreadorNotasAjuste %>">
                                    <input type="hidden" id="arrResModificadorHidden<%=k%>_<%=n%>_<%=q%>" value="<%= arrResModificadorNotasAjuste %>">
                                    <input type="hidden" id="arrResFechaHidden<%=k%>_<%=n%>_<%=q%>" value="<%= arrResFechaNotasAjuste %>">
                                    <input type="hidden" id="arrResFechaModificacionHidden<%=k%>_<%=n%>_<%=q%>" value="<%= arrResFechaModNotasAjuste %>">

                                    <span id="resDatoNotasAjuste<%=k%>_<%=n%>_<%=q%>" class="badge bg-light text-dark my-2">
                                        <%= resDatoNotasAjuste %>
                                    </span> |

                                    <span id="resRevisionNotasAjuste<%=k%>_<%=n%>_<%=q%>" name="resRevisionNotasAjuste" class="badge text-dark my-2" style="cursor: help;" valueCreador="" valueFecha="" valueModificador="" valueFechaMod="">
                                        <%= resRevisionNotasAjuste %>
                                    </span>

                                    <button id="btnSiguienteNotasAjuste<%=k%>_<%=n%>_<%=q%>" name="btnSiguienteNotasAjuste" value="<%=k%>_<%=n%>_<%=q%>" class="btn btn-light btn-sm ms-2" title="Ver siguiente" type="button"
                                        style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .35rem; --bs-btn-font-size: .75rem; color: var(--bs-black); cursor: pointer;"
                                        <%= siguienteDisabled %>
                                        ><i class="fa-solid fa-arrow-right"></i>
                                    </button>
                                </div>
                            </td>
                            <% }
                        } %>
                    </tr>

                <% } else { %>
                    <!--Inactivo-->
                    <tr name="rowSelected<%=k%>_<%=n%>" class="pe-none border-bottom" style="height: 7vh; background-color: #dedede;">
                        <% for (let q = 38; totalColDataPendientesFinales > q; q++) {
                            if (q==38) { %>
                                <!-- Pendientes Maquina data Inactivo -->
                                <td class="text-center align-middle">
                                    <% if (largoArrayPendientesFinales > 0) {
                                        for (let i = 0; largoArrayPendientesFinales > i; i++) {

                                            if (pathToMongoOtPendientesFinales[i]) {
                                                let largoArray = parseInt(largoArrayPendientesFinales)
                                                resDatoPendientesMaquina = pathToMongoOtPendientesFinales[largoArray-1].pendientesMaquina || 'S/D'
                                                resEstadoPendientesMaquina = pathToMongoOtPendientesFinales[largoArray-1].estadoPendientesMaquina || 'sinDato'
                                                resRevisionPendientesMaquina = parseInt(pathToMongoOtPendientesFinales[largoArray-1].revisionPendientesMaquina) || 0
                                                
                                                arrResDatoPendientesMaquina.push(pathToMongoOtPendientesFinales[i].pendientesMaquina)
                                                arrResEstadoPendientesMaquina.push(pathToMongoOtPendientesFinales[i].estadoPendientesMaquina)
                                                arrResRevisionPendientesMaquina.push(pathToMongoOtPendientesFinales[i].revisionPendientesMaquina)
                                            }
                                        }
                                        valueArrayResPendientesMaquina = parseInt(arrResEstadoPendientesMaquina.length-1)
                                        resDatoPendientesMaquina = pathToMongoOtPendientesFinales[0].PendientesMaquina
                                        resEstadoPendientesMaquina = pathToMongoOtPendientesFinales[0].estadoPendientesMaquina

                                    } else {
                                        arrResDatoPendientesMaquina.push(resDatoPendientesMaquina)
                                        arrResEstadoPendientesMaquina.push(resEstadoPendientesMaquina)
                                        arrResRevisionPendientesMaquina.push(resRevisionPendientesMaquina)
                                    } %>
                                    <input type="hidden" id="resDatoHidden<%=k%>_<%=n%>_<%=q%>" value="<%= arrResDatoPendientesMaquina %>">
                                    <input type="hidden" id="resEstadoHidden<%=k%>_<%=n%>_<%=q%>" value="<%= arrResEstadoPendientesMaquina %>">
                                    <input type="hidden" id="resIndexHidden<%=k%>_<%=n%>_<%=q%>" value="<%= valueArrayResPendientesMaquina %>">
                                    <input type="hidden" id="resRevisionHidden<%=k%>_<%=n%>_<%=q%>" value="<%= arrResRevisionPendientesMaquina %>">
                                
                                    <span id="resDatoPendientesMaquina<%=k%>_<%=n%>_<%=q%>" class="badge bg-secondary text-ligth my-2">
                                        <%= resDatoPendientesMaquina %>
                                    </span> |

                                    <% const config = pendientesFinalesConfig[resEstadoPendientesMaquina] || pendientesFinalesConfig.default; %>
                                    <span id="resEstadoPendientesMaquina<%=k%>_<%=n%>_<%=q%>" value="<%=resEstadoPendientesMaquina%>">
                                        <i class="fa-solid <%= config.icon %> fa-lg" style="<%= config.iconColor %>"></i>
                                    </span> |

                                    <span id="resRevisionPendientesMaquina<%=k%>_<%=n%>_<%=q%>" name="resRevisionPendientesMaquina" class="badge text-dark my-2" style="cursor: help;" valueCreador="" valueFecha="" valueModificador="" valueFechaMod="">
                                        <%= resRevisionPendientesMaquina %>
                                    </span>
                                </td>

                            <% } else if (q==39) { %>
                                <!-- Pendientes Ajuste data Inactivo -->
                                <td class="text-center align-middle">
                                    <% if (largoArrayPendientesFinales > 0) {
                                        for (let i = 0; largoArrayPendientesFinales > i; i++) {
                                            
                                            if (pathToMongoOtPendientesFinales[i]) {
                                                let largoArray = parseInt(largoArrayPendientesFinales)
                                                resDatoPendientesAjuste = pathToMongoOtPendientesFinales[largoArray-1].pendientesAjuste || 'S/D'
                                                resEstadoPendientesAjuste = pathToMongoOtPendientesFinales[largoArray-1].pendientesAjuste || 'sinDato'
                                                resRevisionPendientesAjuste = parseInt(pathToMongoOtPendientesFinales[largoArray-1].revisionPendientesAjuste) || 0
                                                
                                                arrResDatoPendientesAjuste.push(pathToMongoOtPendientesFinales[i].pendientesAjuste)
                                                arrResEstadoPendientesAjuste.push(pathToMongoOtPendientesFinales[i].pendientesAjuste)
                                                arrResRevisionPendientesAjuste.push(pathToMongoOtPendientesFinales[i].revisionPendientesAjuste)
                                            }
                                        }
                                        valueArrayResPendientesAjuste = parseInt(arrResEstadoPendientesAjuste.length-1)
                                        resDatoPendientesAjuste = pathToMongoOtPendientesFinales[0].pendientesAjuste
                                        resEstadoPendientesAjuste = pathToMongoOtPendientesFinales[0].estadoPendientesAjuste
                                    
                                    } else {
                                        arrResDatoPendientesAjuste.push(resDatoPendientesAjuste)
                                        arrResEstadoPendientesAjuste.push(resEstadoPendientesAjuste)
                                        arrResRevisionPendientesAjuste.push(resRevisionPendientesAjuste)
                                    } %>
                                    <input type="hidden" id="resDatoHidden<%=k%>_<%=n%>_<%=q%>" value="<%= arrResDatoPendientesAjuste %>">
                                    <input type="hidden" id="resEstadoHidden<%=k%>_<%=n%>_<%=q%>" value="<%= arrResEstadoPendientesAjuste %>">
                                    <input type="hidden" id="resIndexHidden<%=k%>_<%=n%>_<%=q%>" value="<%= valueArrayResPendientesAjuste %>">
                                    <input type="hidden" id="resRevisionHidden<%=k%>_<%=n%>_<%=q%>" value="<%= arrResRevisionPendientesAjuste %>">

                                    <span id="resDatoPendientesAjuste<%=k%>_<%=n%>_<%=q%>" class="badge bg-secondary text-ligth my-2">
                                        <%= resDatoPendientesAjuste %>
                                    </span> |
                                    
                                    <% const config = pendientesFinalesConfig[resEstadoPendientesAjuste] || pendientesFinalesConfig.default; %>
                                    <span id="resEstadoPendientesAjuste<%=k%>_<%=n%>_<%=q%>" value="<%=resEstadoPendientesAjuste%>">
                                        <i class="fa-solid <%= config.icon %> fa-lg" style="<%= config.iconColor %>"></i>
                                    </span> |

                                    <span id="resRevisionPendientesAjuste<%=k%>_<%=n%>_<%=q%>" name="resRevisionPendientesAjuste" class="badge text-dark my-2" style="cursor: help;" valueCreador="" valueFecha="" valueModificador="" valueFechaMod="">
                                        <%= resRevisionPendientesAjuste %>
                                    </span>
                                </td>

                            <% } else { %>
                                <!-- Notas Ajuste data Inactivo -->
                                <td class="text-center align-middle">
                                    <% if (largoArrayPendientesFinales > 0) {
                                        for (let i = 0; largoArrayPendientesFinales > i; i++) {
                                            
                                            if (pathToMongoOtPendientesFinales[i]) {
                                                let largoArray = parseInt(largoArrayPendientesFinales)
                                                resDatoNotasAjuste = pathToMongoOtPendientesFinales[largoArray-1].notasAjuste || "S/D"
                                                resRevisionNotasAjuste = parseInt(pathToMongoOtPendientesFinales[largoArray-1].revisionNotasAjuste) || 0
                                                
                                                arrResDatoNotasAjuste.push(pathToMongoOtPendientesFinales[i].notasAjuste)
                                                arrResEstadoNotasAjuste.push(pathToMongoOtPendientesFinales[i].estadoNotasAjuste)
                                                arrResRevisionNotasAjuste.push(pathToMongoOtPendientesFinales[i].revisionNotasAjuste)
                                            }
                                        }
                                        valueArrayResNotasAjuste = parseInt(arrResEstadoNotasAjuste.length-1)
                                        resDatoNotasAjuste = pathToMongoOtPendientesFinales[0].notasAjuste
                                    
                                    } else {
                                        arrResDatoNotasAjuste.push(resDatoNotasAjuste)
                                        arrResEstadoNotasAjuste.push(resEstadoNotasAjuste)
                                        arrResRevisionNotasAjuste.push(resRevisionNotasAjuste)
                                    } %>
                                    <input type="hidden" id="resDatoHidden<%=k%>_<%=n%>_<%=q%>" value="<%= arrResDatoNotasAjuste %>">
                                    <input type="hidden" id="resIndexHidden<%=k%>_<%=n%>_<%=q%>" value="<%= valueArrayResNotasAjuste %>">
                                    <input type="hidden" id="resRevisionHidden<%=k%>_<%=n%>_<%=q%>" value="<%= arrResRevisionNotasAjuste %>">

                                    <span id="resDatoNotasAjuste<%=k%>_<%=n%>_<%=q%>" class="badge bg-secondary text-ligth my-2">
                                        <%= resDatoNotasAjuste %>
                                    </span> |
                                    
                                    <span id="resRevisionNotasAjuste<%=k%>_<%=n%>_<%=q%>" name="resRevisionNotasAjuste" class="badge text-dark my-2" style="cursor: help;" valueCreador="" valueFecha="" valueModificador="" valueFechaMod="">
                                        <%= resRevisionNotasAjuste %>
                                    </span>
                                </td>
                            <% }
                        } %>
                    </tr>
                <% }
            }
        }) %>
    </tbody>
</table>