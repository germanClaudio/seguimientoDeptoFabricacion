<!-- tabla Etapa Tercera Segunda -->
<table id="tablaOtEtapaTerceraSegunda<%=k%>" class="table-responsive align-middle col-5 border-end border-dark" style="font-size: 10pt; width: 100%">
    <thead class="align-middle" style="background-color: #d8d8eb">
        <tr>
            <th colspan="3" class="text-center">ETAPA 3 (2Â° Parte)
                <% if (userInfo.admin || userInfo.area === 'fabricacion') { %>
                    <button id="posBtnAddDataOtEtapaTerceraSegunda<%=k%>" type="button" name="btnOtEtapaTerceraSegunda" class="btn btn-small btn-success shadow m-1 me-5 position-relative" style="--bs-btn-font-size: .6rem; color: var(--bs-white);" title="Agregar/Modificar Datos" value="<%=k%>">
                        <i class="fa-solid fa-pencil fa-lg" aria-hidden="true"></i>
                        <span id="spanCheckSelecMasiveEtapaTerSeg<%=k%>" class="position-absolute top-100 start-100 translate-middle badge rounded-pill bg-danger">
                            0
                            <span class="visually-hidden">Elementos seleccionados</span>
                        </span>
                    </button>
                <% } else { %>
                    <button type="button" class="btn btn-small btn-danger shadow m-1 me-5 disabled" style="--bs-btn-font-size: .6rem; color: var(--bs-white);">
                        <i class="fa-solid fa-ban fa-lg" aria-hidden="true"></i>                                                    
                    </button>
                <% } %>
                <i class="fa-solid fa-arrows-spin fa-lg" style="color: #b09b12;"></i> En Proceso -
                <i class="fa-solid fa-circle-check fa-lg" style="color: #008f30;"></i> Terminado -
                <i class="fa-solid fa-circle-xmark fa-lg" style="color: #c40000;"></i> Suspendido -
                <i class="fa-solid fa-ban fa-lg"></i> No Aplica -
                <i class="fa-solid fa-triangle-exclamation fa-lg" style="color: #1c21ac;"></i> Sin Datos
            </th>
        </tr>
        <tr>
            <th id="colData0" style="width:33vw" scope="col-1" class="text-center pb-1">Funcional Completa | Estado | Rev.</th>
            <th id="colData1" style="width:33vw" scope="col-1" class="text-center pb-1">LTH | Estado | Rev.</th>
            <th id="colData2" style="width:33vw" scope="col-1" class="text-center pb-1">Lib. Pza./Metrologia | Estado | Rev.</th>
        </tr>
    </thead>
    <tbody class="table-group-divider">
        
        <% const etapaTerceraSegundaConfig = {
                enProceso: { icon: "fa-arrows-spin fa-spin", iconColor: "color:#b09b12" },
                terminado: { icon: "fa-circle-check", iconColor: "color:#008f30" },
                suspendido: { icon: "fa-circle-xmark", iconColor: "color:#c40000" },
                noAplica: { icon: "fa-ban", iconColor: "color:#000000" },
                default: { icon: "fa-triangle-exclamation", iconColor: "color:#1c21ac" }
            };

        proyecto[m].project[j].oci[k].otProject.forEach((ot, n) => {
            let pathMongoOtProject = proyecto[m].project[j].oci[k].otProject,
            pathMongoOtAjuste = pathMongoOtProject[n].otAjuste,
            largoArrayOtAjuste = parseInt(pathMongoOtAjuste.length)

            let anteriorDisabled = "disabled", siguienteDisabled = "disabled",
                resDatoFuncionalCompleta = "S/D", resEstadoFuncionalCompleta = 'sinDato', resRevisionFuncionalCompleta = 0,
                resDatoLthEtapaTercera = "S/D", resEstadoLthEtapaTercera = 'sinDato', resRevisionLthEtapaTercera = 0,
                resDatoLiberarPiezaMetrologia = "S/D", resEstadoLiberarPiezaMetrologia = 'sinDato', resRevisionLiberarPiezaMetrologia = 0;

            for ( let o=0; largoArrayOtAjuste> o; o++) {
                let pathToMongoOtEtapaTerceraSegunda = pathMongoOtAjuste[o].otEtapaTerceraSegunda || [];
                let largoArrayEtapaTerceraSegunda = parseInt(pathToMongoOtEtapaTerceraSegunda.length);

                let arrResDatoFuncionalCompleta = [], arrResEstadoFuncionalCompleta = [], valueArrayResFuncionalCompleta = 0, arrResRevisionFuncionalCompleta = [],
                arrResCreadorFuncionalCompleta = [], arrResModificadorFuncionalCompleta = [], arrResFechaFuncionalCompleta = [], arrResFechaModFuncionalCompleta = [];

                let arrResDatoLthEtapaTercera = [], arrResEstadoLthEtapaTercera = [], valueArrayResLthEtapaTercera = 0, arrResRevisionLthEtapaTercera = [],
                arrResCreadorLthEtapaTercera = [], arrResModificadorLthEtapaTercera = [], arrResFechaLthEtapaTercera = [], arrResFechaModLthEtapaTercera = [];

                let arrResDatoLiberarPiezaMetrologia = [], arrResEstadoLiberarPiezaMetrologia = [], valueArrayResLiberarPiezaMetrologia = 0, arrResRevisionLiberarPiezaMetrologia = [],
                arrResCreadorLiberarPiezaMetrologia = [], arrResModificadorLiberarPiezaMetrologia = [], arrResFechaLiberarPiezaMetrologia = [], arrResFechaModLiberarPiezaMetrologia = [];

                if (pathMongoOtProject[n].visible && pathMongoOtAjuste[o].visible) {
                    if (pathMongoOtProject[n].otStatus) { %>
                        <!--Activo-->
                        <tr name="rowSelected<%=k%>_<%=n%>_<%=o%>" class="border-bottom" style="height: 5vh;">
                            <% for (let q = 18; totalColDataEtapaTerceraSegunda > q; q++) {
                                if (q==18) { %>
                                    <!-- Funcional Completa data Activo--> 
                                    <td class="text-center align-middle">
                                        <% if (largoArrayOtAjuste > 0 && largoArrayEtapaTerceraSegunda > 0) {

                                            for (let i = 0; largoArrayEtapaTerceraSegunda > i; i++) {
                                                if (pathToMongoOtEtapaTerceraSegunda[i]) {
                                                    let largoArray = parseInt(largoArrayEtapaTerceraSegunda)
                                                    resDatoFuncionalCompleta = pathToMongoOtEtapaTerceraSegunda[largoArray-1].funcionalCompleta == 'sinDato' ? "S/D" : pathToMongoOtEtapaTerceraSegunda[largoArray-1].funcionalCompleta
                                                    resEstadoFuncionalCompleta = pathToMongoOtEtapaTerceraSegunda[largoArray-1].estadoFuncionalCompleta == 'sinDato' ? "S/D" : pathToMongoOtEtapaTerceraSegunda[largoArray-1].estadoFuncionalCompleta
                                                    resRevisionFuncionalCompleta = parseInt(pathToMongoOtEtapaTerceraSegunda[largoArray-1].revisionFuncionalCompleta) || 0
                                                    
                                                    pathToMongoOtEtapaTerceraSegunda[i].funcionalCompleta == 'sinDato' ? arrResDatoFuncionalCompleta.push("S/D") : arrResDatoFuncionalCompleta.push(pathToMongoOtEtapaTerceraSegunda[i].funcionalCompleta)
                                                    pathToMongoOtEtapaTerceraSegunda[i].estadoFuncionalCompleta == 'sinDato' ? arrResEstadoFuncionalCompleta.push("S/D") : arrResEstadoFuncionalCompleta.push(pathToMongoOtEtapaTerceraSegunda[i].estadoFuncionalCompleta)
                                                    arrResRevisionFuncionalCompleta.push(pathToMongoOtEtapaTerceraSegunda[i].revisionFuncionalCompleta)

                                                    arrResCreadorFuncionalCompleta.push(pathToMongoOtEtapaTerceraSegunda[i].creator[0].username)
                                                    arrResModificadorFuncionalCompleta.push(pathToMongoOtEtapaTerceraSegunda[i].modificator[0].username)
                                                    arrResFechaFuncionalCompleta.push(pathToMongoOtEtapaTerceraSegunda[i].timestamp)
                                                    arrResFechaModFuncionalCompleta.push(pathToMongoOtEtapaTerceraSegunda[i].modifiedOn)
                                                }
                                            }
                                            valueArrayResFuncionalCompleta = parseInt(arrResDatoFuncionalCompleta.length-1)

                                            if (arrResDatoFuncionalCompleta.length == 1 ) {
                                                anteriorDisabled = "disabled"
                                                siguienteDisabled = "disabled"
                                            } else if (arrResDatoFuncionalCompleta.length == arrResRevisionFuncionalCompleta.length) {
                                                anteriorDisabled = ""
                                                siguienteDisabled = "disabled"
                                            } else {
                                                anteriorDisabled = ""
                                                siguienteDisabled = "disabled"
                                            }
                                            
                                        } else {
                                            arrResDatoFuncionalCompleta.push(resDatoFuncionalCompleta)
                                            arrResEstadoFuncionalCompleta.push(resEstadoFuncionalCompleta)
                                            arrResRevisionFuncionalCompleta.push(resRevisionFuncionalCompleta)
                                            
                                            arrResCreadorFuncionalCompleta.push(pathMongoOtAjuste[o].creator[0].username)
                                            arrResModificadorFuncionalCompleta = ""
                                            arrResFechaFuncionalCompleta.push(pathMongoOtAjuste[o].timestamp)
                                            arrResFechaModFuncionalCompleta = ""
                                        } %>
                                        
                                        <div id="btnAnteriorSiguienteFuncionalCompleta<%=k%>_<%=n%>_<%=o%>_<%=q%>">
                                            <button id="btnAnteriorFuncionalCompleta<%=k%>_<%=n%>_<%=o%>_<%=q%>" name="btnAnteriorFuncionalCompleta" value="<%=k%>_<%=n%>_<%=o%>_<%=q%>" class="btn btn-light btn-sm me-2" title="Ver anterior" type="button"
                                                style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .35rem; --bs-btn-font-size: .75rem; color: var(--bs-black); cursor: pointer;"
                                                <%= anteriorDisabled %>
                                                ><i class="fa-solid fa-arrow-left"></i>
                                            </button>
                                            <input type="hidden" id="resDatoHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= arrResDatoFuncionalCompleta %>">
                                            <input type="hidden" id="resEstadoHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= arrResEstadoFuncionalCompleta %>">
                                            <input type="hidden" id="resIndexHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= valueArrayResFuncionalCompleta %>">
                                            <input type="hidden" id="resRevisionHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= arrResRevisionFuncionalCompleta %>">
                                            <input type="hidden" id="arrResCreadorHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= arrResCreadorFuncionalCompleta %>">
                                            <input type="hidden" id="arrResModificadorHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= arrResModificadorFuncionalCompleta %>">
                                            <input type="hidden" id="arrResFechaHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= arrResFechaFuncionalCompleta %>">
                                            <input type="hidden" id="arrResFechaModificacionHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= arrResFechaModFuncionalCompleta %>">

                                            <span id="resDatoFuncionalCompleta<%=k%>_<%=n%>_<%=o%>_<%=q%>" class="badge bg-light text-dark my-2">
                                                <%= resDatoFuncionalCompleta %>
                                            </span> |
                                            
                                            <% const config = etapaTerceraSegundaConfig[resEstadoFuncionalCompleta] || etapaTerceraSegundaConfig.default; %>
                                            <span id="resEstadoFuncionalCompleta<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%=resEstadoFuncionalCompleta%>">
                                                <i class="fa-solid <%= config.icon %> fa-lg" style="<%= config.iconColor %>"></i>
                                            </span> |

                                            <span id="resRevisionFuncionalCompleta<%=k%>_<%=n%>_<%=o%>_<%=q%>" name="resRevisionFuncionalCompleta" class="badge text-dark my-2" style="cursor: help;" valueCreador="" valueFecha="" valueModificador="" valueFechaMod="">
                                                <%= resRevisionFuncionalCompleta %>
                                            </span>

                                            <button id="btnSiguienteFuncionalCompleta<%=k%>_<%=n%>_<%=o%>_<%=q%>" name="btnSiguienteFuncionalCompleta" value="<%=k%>_<%=n%>_<%=o%>_<%=q%>" class="btn btn-light btn-sm ms-2" title="Ver siguiente" type="button"
                                                style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .35rem; --bs-btn-font-size: .75rem; color: var(--bs-black); cursor: pointer;" <%= siguienteDisabled %>
                                                ><i class="fa-solid fa-arrow-right"></i>
                                            </button>
                                        </div>
                                    </td>

                                <% } else if (q==19) { %>
                                    <!-- LTH Etapa Tercera data Activo-->
                                    <td class="text-center align-middle">
                                        <% if (largoArrayOtAjuste > 0 && largoArrayEtapaTerceraSegunda > 0) {

                                            for (let i = 0; largoArrayEtapaTerceraSegunda > i; i++) {
                                                if (pathToMongoOtEtapaTerceraSegunda[i]) {
                                                    let largoArray = parseInt(largoArrayEtapaTerceraSegunda)
                                                    resDatoLthEtapaTercera = pathToMongoOtEtapaTerceraSegunda[largoArray-1].lthEtapaTercera == 'sinDato' ? "S/D" :  pathToMongoOtEtapaTerceraSegunda[largoArray-1].lthEtapaTercera
                                                    resEstadoLthEtapaTercera = pathToMongoOtEtapaTerceraSegunda[largoArray-1].estadoLthEtapaTercera == 'sinDato' ? "S/D" : pathToMongoOtEtapaTerceraSegunda[largoArray-1].estadoLthEtapaTercera
                                                    resRevisionLthEtapaTercera = parseInt(pathToMongoOtEtapaTerceraSegunda[largoArray-1].revisionLthEtapaTercera) || 0
                                                    
                                                    pathToMongoOtEtapaTerceraSegunda[i].lthEtapaTercera == 'sinDato' ? arrResDatoLthEtapaTercera.push("S/D") : arrResDatoLthEtapaTercera.push(pathToMongoOtEtapaTerceraSegunda[i].lthEtapaTercera)
                                                    pathToMongoOtEtapaTerceraSegunda[i].estadoLthEtapaTercera == 'sinDato' ? arrResEstadoLthEtapaTercera.push("S/D") : arrResEstadoLthEtapaTercera.push(pathToMongoOtEtapaTerceraSegunda[i].estadoLthEtapaTercera)
                                                    arrResRevisionLthEtapaTercera.push(pathToMongoOtEtapaTerceraSegunda[i].revisionLthEtapaTercera)
                                                    
                                                    arrResCreadorLthEtapaTercera.push(pathToMongoOtEtapaTerceraSegunda[i].creator[0].username)
                                                    arrResModificadorLthEtapaTercera.push(pathToMongoOtEtapaTerceraSegunda[i].modificator[0].username)
                                                    arrResFechaLthEtapaTercera.push(pathToMongoOtEtapaTerceraSegunda[i].timestamp)
                                                    arrResFechaModLthEtapaTercera.push(pathToMongoOtEtapaTerceraSegunda[i].modifiedOn)
                                                }
                                            }
                                            valueArrayResLthEtapaTercera = parseInt(arrResEstadoLthEtapaTercera.length-1)
                                                    
                                            if (arrResDatoLthEtapaTercera.length == 1 ) {
                                                anteriorDisabled = "disabled"
                                                siguienteDisabled = "disabled"
                                            } else if (arrResDatoLthEtapaTercera.length == arrResRevisionLthEtapaTercera.length) {
                                                anteriorDisabled = ""
                                                siguienteDisabled = "disabled"
                                            } else {
                                                anteriorDisabled = ""
                                                siguienteDisabled = "disabled"
                                            }
                                            
                                        } else {
                                            arrResDatoLthEtapaTercera.push(resDatoLthEtapaTercera)
                                            arrResEstadoLthEtapaTercera.push(resEstadoLthEtapaTercera)
                                            arrResRevisionLthEtapaTercera.push(resRevisionLthEtapaTercera)
                                            
                                            arrResCreadorLthEtapaTercera.push(pathMongoOtAjuste[o].creator[0].username)
                                            arrResModificadorLthEtapaTercera = ""
                                            arrResFechaLthEtapaTercera.push(pathMongoOtAjuste[o].timestamp)
                                            arrResFechaModLthEtapaTercera = ""
                                        } %>
                                        
                                        <div id="btnAnteriorSiguienteLthEtapaTercera<%=k%>_<%=n%>_<%=o%>_<%=q%>">
                                            <button id="btnAnteriorLthEtapaTercera<%=k%>_<%=n%>_<%=o%>_<%=q%>" name="btnAnteriorLthEtapaTercera" value="<%=k%>_<%=n%>_<%=o%>_<%=q%>" class="btn btn-light btn-sm me-2" title="Ver anterior" type="button"
                                                style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .35rem; --bs-btn-font-size: .75rem; color: var(--bs-black); cursor: pointer;"
                                                <%= anteriorDisabled %>
                                                ><i class="fa-solid fa-arrow-left"></i>
                                            </button>
                                            <input type="hidden" id="resDatoHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= arrResDatoLthEtapaTercera %>">
                                            <input type="hidden" id="resEstadoHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= arrResEstadoLthEtapaTercera %>">
                                            <input type="hidden" id="resIndexHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= valueArrayResLthEtapaTercera %>">
                                            <input type="hidden" id="resRevisionHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= arrResRevisionLthEtapaTercera %>">
                                            <input type="hidden" id="arrResCreadorHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= arrResCreadorLthEtapaTercera %>">
                                            <input type="hidden" id="arrResModificadorHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= arrResModificadorLthEtapaTercera %>">
                                            <input type="hidden" id="arrResFechaHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= arrResFechaLthEtapaTercera %>">
                                            <input type="hidden" id="arrResFechaModificacionHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= arrResFechaModLthEtapaTercera %>">

                                            <span id="resDatoLthEtapaTercera<%=k%>_<%=n%>_<%=o%>_<%=q%>" class="badge bg-light text-dark my-2">
                                                <%= resDatoLthEtapaTercera %>
                                            </span> |

                                            <% const config = etapaTerceraSegundaConfig[resEstadoLthEtapaTercera] || etapaTerceraSegundaConfig.default; %>
                                            <span id="resEstadoLthEtapaTercera<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%=resEstadoLthEtapaTercera%>">
                                                <i   class="fa-solid <%= config.icon %> fa-lg" style="<%= config.iconColor %>"></i>
                                            </span> |

                                            <span id="resRevisionLthEtapaTercera<%=k%>_<%=n%>_<%=o%>_<%=q%>" name="resRevisionLthEtapaTercera" class="badge text-dark my-2" style="cursor: help;" valueCreador="" valueFecha="" valueModificador="" valueFechaMod="">
                                                <%= resRevisionLthEtapaTercera %>
                                            </span>

                                            <button id="btnSiguienteLthEtapaTercera<%=k%>_<%=n%>_<%=o%>_<%=q%>" name="btnSiguienteLthEtapaTercera" value="<%=k%>_<%=n%>_<%=o%>_<%=q%>" class="btn btn-light btn-sm ms-2" title="Ver siguiente" type="button"
                                                style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .35rem; --bs-btn-font-size: .75rem; color: var(--bs-black); cursor: pointer;"
                                                <%= siguienteDisabled %>
                                                ><i class="fa-solid fa-arrow-right"></i>
                                            </button>
                                        </div>
                                    </td>

                                <% } else { %>
                                    <!-- Liberar Pieza Metrologia data Activo-->
                                    <td class="text-center align-middle">
                                        <% if (largoArrayOtAjuste > 0 && largoArrayEtapaTerceraSegunda > 0) {

                                            for (let i = 0; largoArrayEtapaTerceraSegunda > i; i++) {
                                                if (pathToMongoOtEtapaTerceraSegunda[i]) {
                                                    let largoArray = parseInt(largoArrayEtapaTerceraSegunda)
                                                    resDatoLiberarPiezaMetrologia = pathToMongoOtEtapaTerceraSegunda[largoArray-1].liberarPiezaMetrologia == 'sinDato' ? "S/D" : pathToMongoOtEtapaTerceraSegunda[largoArray-1].liberarPiezaMetrologia
                                                    resEstadoLiberarPiezaMetrologia = pathToMongoOtEtapaTerceraSegunda[largoArray-1].estadoLiberarPiezaMetrologia == 'sinDato' ? 'sinDato' : pathToMongoOtEtapaTerceraSegunda[largoArray-1].estadoLiberarPiezaMetrologia
                                                    resRevisionLiberarPiezaMetrologia = parseInt(pathToMongoOtEtapaTerceraSegunda[largoArray-1].revisionLiberarPiezaMetrologia) || 0
                                                    
                                                    pathToMongoOtEtapaTerceraSegunda[i].liberarPiezaMetrologia == 'sinDato' ? arrResDatoLiberarPiezaMetrologia.push('S/D') : arrResDatoLiberarPiezaMetrologia.push(pathToMongoOtEtapaTerceraSegunda[i].liberarPiezaMetrologia)
                                                    pathToMongoOtEtapaTerceraSegunda[i].estadoLiberarPiezaMetrologia == 'sinDato' ? arrResEstadoLiberarPiezaMetrologia.push('S/D') : arrResEstadoLiberarPiezaMetrologia.push(pathToMongoOtEtapaTerceraSegunda[i].estadoLiberarPiezaMetrologia)
                                                    arrResRevisionLiberarPiezaMetrologia.push(pathToMongoOtEtapaTerceraSegunda[i].revisionLiberarPiezaMetrologia)
                                                
                                                    arrResCreadorLiberarPiezaMetrologia.push(pathToMongoOtEtapaTerceraSegunda[i].creator[0].username)
                                                    arrResModificadorLiberarPiezaMetrologia.push(pathToMongoOtEtapaTerceraSegunda[i].modificator[0].username)
                                                    arrResFechaLiberarPiezaMetrologia.push(pathToMongoOtEtapaTerceraSegunda[i].timestamp)
                                                    arrResFechaModLiberarPiezaMetrologia.push(pathToMongoOtEtapaTerceraSegunda[i].modifiedOn)
                                                }
                                            }
                                            valueArrayResLiberarPiezaMetrologia = parseInt(arrResEstadoLiberarPiezaMetrologia.length-1)
                                                    
                                            if (arrResDatoLiberarPiezaMetrologia.length == 1 ) {
                                                siguienteDisabled = "disabled"
                                                anteriorDisabled = "disabled"
                                            } else if (arrResDatoLiberarPiezaMetrologia.length == arrResRevisionLiberarPiezaMetrologia.length) {
                                                anteriorDisabled = ""
                                                siguienteDisabled = "disabled"
                                            } else {
                                                anteriorDisabled = ""
                                                siguienteDisabled = "disabled"
                                            }
                                                    
                                        } else {
                                            arrResDatoLiberarPiezaMetrologia.push(resDatoLiberarPiezaMetrologia)
                                            arrResEstadoLiberarPiezaMetrologia.push(resEstadoLiberarPiezaMetrologia)
                                            arrResRevisionLiberarPiezaMetrologia.push(resRevisionLiberarPiezaMetrologia)
                                            
                                            arrResCreadorLiberarPiezaMetrologia.push(pathMongoOtAjuste[o].creator[0].username)
                                            arrResModificadorLiberarPiezaMetrologia = ""
                                            arrResFechaLiberarPiezaMetrologia.push(pathMongoOtAjuste[o].timestamp)
                                            arrResFechaModLiberarPiezaMetrologia = ""
                                        } %>

                                    <div id="btnAnteriorSiguienteLiberarPiezaMetrologia<%=k%>_<%=n%>_<%=o%>_<%=q%>">
                                        <button id="btnAnteriorLiberarPiezaMetrologia<%=k%>_<%=n%>_<%=o%>_<%=q%>" name="btnAnteriorLiberarPiezaMetrologia" value="<%=k%>_<%=n%>_<%=o%>_<%=q%>" class="btn btn-light btn-sm me-2" title="Ver anterior" type="button"
                                            style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .35rem; --bs-btn-font-size: .75rem; color: var(--bs-black); cursor: pointer;"
                                            <%= anteriorDisabled %>
                                            ><i class="fa-solid fa-arrow-left"></i>
                                        </button>
                                        <input type="hidden" id="resDatoHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= arrResDatoLiberarPiezaMetrologia %>">
                                        <input type="hidden" id="resEstadoHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= arrResEstadoLiberarPiezaMetrologia %>">
                                        <input type="hidden" id="resIndexHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= valueArrayResLiberarPiezaMetrologia %>">
                                        <input type="hidden" id="resRevisionHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= arrResRevisionLiberarPiezaMetrologia %>">
                                        <input type="hidden" id="arrResCreadorHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= arrResCreadorLiberarPiezaMetrologia %>">
                                        <input type="hidden" id="arrResModificadorHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= arrResModificadorLiberarPiezaMetrologia %>">
                                        <input type="hidden" id="arrResFechaHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= arrResFechaLiberarPiezaMetrologia %>">
                                        <input type="hidden" id="arrResFechaModificacionHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= arrResFechaModLiberarPiezaMetrologia %>">

                                        <span id="resDatoLiberarPiezaMetrologia<%=k%>_<%=n%>_<%=o%>_<%=q%>" class="badge bg-light text-dark my-2">
                                            <%= resDatoLiberarPiezaMetrologia %>
                                        </span> |

                                        <% const config = etapaTerceraSegundaConfig[resEstadoLiberarPiezaMetrologia] || etapaTerceraSegundaConfig.default; %>
                                        <span id="resEstadoLiberarPiezaMetrologia<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%=resEstadoLiberarPiezaMetrologia%>">
                                            <i class="fa-solid <%= config.icon %> fa-lg" style="<%= config.iconColor %>"></i>
                                        </span> |

                                        <span id="resRevisionLiberarPiezaMetrologia<%=k%>_<%=n%>_<%=o%>_<%=q%>" name="resRevisionLiberarPiezaMetrologia" class="badge text-dark my-2" style="cursor: help;" valueCreador="" valueFecha="" valueModificador="" valueFechaMod="">
                                            <%= resRevisionLiberarPiezaMetrologia %>
                                        </span>

                                        <button id="btnSiguienteLiberarPiezaMetrologia<%=k%>_<%=n%>_<%=o%>_<%=q%>" name="btnSiguienteLiberarPiezaMetrologia" value="<%=k%>_<%=n%>_<%=o%>_<%=q%>" class="btn btn-light btn-sm ms-2" title="Ver siguiente" type="button"
                                            style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .35rem; --bs-btn-font-size: .75rem; color: var(--bs-black); cursor: pointer;"
                                            <%= siguienteDisabled %>
                                            ><i class="fa-solid fa-arrow-right"></i>
                                        </button>
                                    </div>
                                </td>
                                <% }
                            } %>
                        </tr>

                    <% } else { %>
                        <!--Inactivo-->
                        <tr name="rowSelected<%=k%>_<%=n%>_<%=o%>" class="pe-none border-bottom" style="height: 5vh; background-color: #dedede;">
                            <% for (let q = 18; totalColDataEtapaTerceraSegunda > q; q++) {
                                if (q==18) { %>
                                    <!-- Funcional Completa data Inactivo -->
                                    <td class="text-center align-middle">
                                        <% if (largoArrayOtAjuste > 0 && largoArrayEtapaTerceraSegunda > 0) {
                                            for (let i = 0; largoArrayEtapaTerceraSegunda > i; i++) {

                                                if (pathToMongoOtEtapaTerceraSegunda[i]) {
                                                    let largoArray = parseInt(largoArrayEtapaTerceraSegunda)
                                                    resDatoFuncionalCompleta = pathToMongoOtEtapaTerceraSegunda[largoArray-1].funcionalCompleta || 'S/D'
                                                    resEstadoFuncionalCompleta = pathToMongoOtEtapaTerceraSegunda[largoArray-1].estadoFuncionalCompleta || 'sinDato'
                                                    resRevisionFuncionalCompleta = parseInt(pathToMongoOtEtapaTerceraSegunda[largoArray-1].revisionFuncionalCompleta) || 0
                                                    
                                                    arrResDatoFuncionalCompleta.push(pathToMongoOtEtapaTerceraSegunda[i].funcionalCompleta)
                                                    arrResEstadoFuncionalCompleta.push(pathToMongoOtEtapaTerceraSegunda[i].estadoFuncionalCompleta)
                                                    arrResRevisionFuncionalCompleta.push(pathToMongoOtEtapaTerceraSegunda[i].revisionFuncionalCompleta)
                                                }
                                            }
                                            valueArrayResFuncionalCompleta = parseInt(arrResEstadoFuncionalCompleta.length-1)
                                            resDatoFuncionalCompleta = pathToMongoOtEtapaTerceraSegunda[0].FuncionalCompleta
                                            resEstadoFuncionalCompleta = pathToMongoOtEtapaTerceraSegunda[0].estadoFuncionalCompleta

                                        } else {
                                            arrResDatoFuncionalCompleta.push(resDatoFuncionalCompleta)
                                            arrResEstadoFuncionalCompleta.push(resEstadoFuncionalCompleta)
                                            arrResRevisionFuncionalCompleta.push(resRevisionFuncionalCompleta)
                                        } %>
                                        <input type="hidden" id="resDatoHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= arrResDatoFuncionalCompleta %>">
                                        <input type="hidden" id="resEstadoHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= arrResEstadoFuncionalCompleta %>">
                                        <input type="hidden" id="resIndexHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= valueArrayResFuncionalCompleta %>">
                                        <input type="hidden" id="resRevisionHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= arrResRevisionFuncionalCompleta %>">
                                    
                                        <span id="resDatoFuncionalCompleta<%=k%>_<%=n%>_<%=o%>_<%=q%>" class="badge bg-secondary text-ligth my-2">
                                            <%= resDatoFuncionalCompleta %>
                                        </span> |

                                        <% const config = etapaTerceraSegundaConfig[resEstadoFuncionalCompleta] || etapaTerceraSegundaConfig.default; %>
                                        <span id="resEstadoFuncionalCompleta<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%=resEstadoFuncionalCompleta%>">
                                            <i class="fa-solid <%= config.icon %> fa-lg" style="<%= config.iconColor %>"></i>
                                        </span> |

                                        <span id="resRevisionFuncionalCompleta<%=k%>_<%=n%>_<%=o%>_<%=q%>" name="resRevisionFuncionalCompleta" class="badge text-dark my-2" style="cursor: help;" valueCreador="" valueFecha="" valueModificador="" valueFechaMod="">
                                            <%= resRevisionFuncionalCompleta %>
                                        </span>
                                    </td>

                                <% } else if (q==19) { %>
                                    <!-- LTH Etapa Tercera data Inactivo -->
                                    <td class="text-center align-middle">
                                        <% if (largoArrayOtAjuste > 0 && largoArrayEtapaTerceraSegunda > 0) {
                                            for (let i = 0; largoArrayEtapaTerceraSegunda > i; i++) {
                                                
                                                if (pathToMongoOtEtapaTerceraSegunda[i]) {
                                                    let largoArray = parseInt(largoArrayEtapaTerceraSegunda)
                                                    resDatoLthEtapaTercera = pathToMongoOtEtapaTerceraSegunda[largoArray-1].lthEtapaTercera || 'S/D'
                                                    resEstadoLthEtapaTercera = pathToMongoOtEtapaTerceraSegunda[largoArray-1].lthEtapaTercera || 'sinDato'
                                                    resRevisionLthEtapaTercera = parseInt(pathToMongoOtEtapaTerceraSegunda[largoArray-1].revisionLthEtapaTercera) || 0
                                                    
                                                    arrResDatoLthEtapaTercera.push(pathToMongoOtEtapaTerceraSegunda[i].lthEtapaTercera)
                                                    arrResEstadoLthEtapaTercera.push(pathToMongoOtEtapaTerceraSegunda[i].lthEtapaTercera)
                                                    arrResRevisionLthEtapaTercera.push(pathToMongoOtEtapaTerceraSegunda[i].revisionLthEtapaTercera)
                                                }
                                            }
                                            valueArrayResLthEtapaTercera = parseInt(arrResEstadoLthEtapaTercera.length-1)
                                            resDatoLthEtapaTercera = pathToMongoOtEtapaTerceraSegunda[0].lthEtapaTercera
                                            resEstadoLthEtapaTercera = pathToMongoOtEtapaTerceraSegunda[0].estadoLthEtapaTercera
                                        
                                        } else {
                                            arrResDatoLthEtapaTercera.push(resDatoLthEtapaTercera)
                                            arrResEstadoLthEtapaTercera.push(resEstadoLthEtapaTercera)
                                            arrResRevisionLthEtapaTercera.push(resRevisionLthEtapaTercera)
                                        } %>
                                        <input type="hidden" id="resDatoHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= arrResDatoLthEtapaTercera %>">
                                        <input type="hidden" id="resEstadoHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= arrResEstadoLthEtapaTercera %>">
                                        <input type="hidden" id="resIndexHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= valueArrayResLthEtapaTercera %>">
                                        <input type="hidden" id="resRevisionHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= arrResRevisionLthEtapaTercera %>">

                                        <span id="resDatoLthEtapaTercera<%=k%>_<%=n%>_<%=o%>_<%=q%>" class="badge bg-secondary text-ligth my-2">
                                            <%= resDatoLthEtapaTercera %>
                                        </span> |
                                        
                                        <% const config = etapaTerceraSegundaConfig[resEstadoLthEtapaTercera] || etapaTerceraSegundaConfig.default; %>
                                        <span id="resEstadoLthEtapaTercera<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%=resEstadoLthEtapaTercera%>">
                                            <i class="fa-solid <%= config.icon %> fa-lg" style="<%= config.iconColor %>"></i>
                                        </span> |

                                        <span id="resRevisionLthEtapaTercera<%=k%>_<%=n%>_<%=o%>_<%=q%>" name="resRevisionLthEtapaTercera" class="badge text-dark my-2" style="cursor: help;" valueCreador="" valueFecha="" valueModificador="" valueFechaMod="">
                                            <%= resRevisionLthEtapaTercera %>
                                        </span>
                                    </td>

                                <% } else { %>
                                    <!-- Liberar Pieza Metrologia data Inactivo -->
                                    <td class="text-center align-middle">
                                        <% if (largoArrayOtAjuste > 0 && largoArrayEtapaTerceraSegunda > 0) {
                                            for (let i = 0; largoArrayEtapaTerceraSegunda > i; i++) {
                                                
                                                if (pathToMongoOtEtapaTerceraSegunda[i]) {
                                                    let largoArray = parseInt(largoArrayEtapaTerceraSegunda)
                                                    resDatoLiberarPiezaMetrologia = pathToMongoOtEtapaTerceraSegunda[largoArray-1].liberarPiezaMetrologia || "S/D"
                                                    resEstadoLiberarPiezaMetrologia = pathToMongoOtEtapaTerceraSegunda[largoArray-1].estadoLiberarPiezaMetrologia || 'sinDato'
                                                    resRevisionLiberarPiezaMetrologia = parseInt(pathToMongoOtEtapaTerceraSegunda[largoArray-1].revisionLiberarPiezaMetrologia) || 0
                                                    
                                                    arrResDatoLiberarPiezaMetrologia.push(pathToMongoOtEtapaTerceraSegunda[i].liberarPiezaMetrologia)
                                                    arrResEstadoLiberarPiezaMetrologia.push(pathToMongoOtEtapaTerceraSegunda[i].estadoLiberarPiezaMetrologia)
                                                    arrResRevisionLiberarPiezaMetrologia.push(pathToMongoOtEtapaTerceraSegunda[i].revisionLiberarPiezaMetrologia)
                                                }
                                            }
                                            valueArrayResLiberarPiezaMetrologia = parseInt(arrResEstadoLiberarPiezaMetrologia.length-1)
                                            resDatoLiberarPiezaMetrologia = pathToMongoOtEtapaTerceraSegunda[0].liberarPiezaMetrologia
                                            resEstadoLiberarPiezaMetrologia = pathToMongoOtEtapaTerceraSegunda[0].estadoLiberarPiezaMetrologia
                                        
                                        } else {
                                            arrResDatoLiberarPiezaMetrologia.push(resDatoLiberarPiezaMetrologia)
                                            arrResEstadoLiberarPiezaMetrologia.push(resEstadoLiberarPiezaMetrologia)
                                            arrResRevisionLiberarPiezaMetrologia.push(resRevisionLiberarPiezaMetrologia)
                                        } %>
                                        <input type="hidden" id="resDatoHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= arrResDatoLiberarPiezaMetrologia %>">
                                        <input type="hidden" id="resEstadoHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= arrResEstadoLiberarPiezaMetrologia %>">
                                        <input type="hidden" id="resIndexHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= valueArrayResLiberarPiezaMetrologia %>">
                                        <input type="hidden" id="resRevisionHidden<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%= arrResRevisionLiberarPiezaMetrologia %>">

                                        <span id="resDatoLiberarPiezaMetrologia<%=k%>_<%=n%>_<%=o%>_<%=q%>" class="badge bg-secondary text-ligth my-2">
                                            <%= resDatoLiberarPiezaMetrologia %>
                                        </span> |
                                        
                                        <% const config = etapaTerceraSegundaConfig[resEstadoLiberarPiezaMetrologia] || etapaTerceraSegundaConfig.default; %>
                                        <span id="resEstadoLiberarPiezaMetrologia<%=k%>_<%=n%>_<%=o%>_<%=q%>" value="<%=resEstadoLiberarPiezaMetrologia%>">
                                            <i class="fa-solid <%= config.icon %> fa-lg" style="<%= config.iconColor %>"></i>
                                        </span> |

                                        <span id="resRevisionLiberarPiezaMetrologia<%=k%>_<%=n%>_<%=o%>_<%=q%>" name="resRevisionLiberarPiezaMetrologia" class="badge text-dark my-2" style="cursor: help;" valueCreador="" valueFecha="" valueModificador="" valueFechaMod="">
                                            <%= resRevisionLiberarPiezaMetrologia %>
                                        </span>
                                    </td>
                                <% }
                            } %>
                        </tr>
                    <% }
                }
            }
        }) %>
    </tbody>
</table>